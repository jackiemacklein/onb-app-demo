(this["webpackJsonponb-app-demo.agenciaonside.com.br"]=this["webpackJsonponb-app-demo.agenciaonside.com.br"]||[]).push([[50],{237:function(e,a,t){"use strict";var n=t(246),s=t.n(n),l=t(18),i=t.n(l),r=s.a.create({baseURL:"https://onb-api-demo.agenciaonside.com.br"});r.interceptors.request.use((function(e){return e.headers.Authorization="bearer "+i.a.get("rui-auth-token"),e}),(function(e){Promise.reject(e)})),a.a=r},854:function(e,a,t){},929:function(e,a,t){"use strict";t.r(a);var n=t(21),s=t(244),l=t.n(s),i=t(245),r=t(2),c=t(3),o=t(14),d=t(5),u=t(4),m=(t(854),t(0)),h=t.n(m),f=t(26),b=t(10),p=t(19),v=t(353),E=t(346),g=t(347),y=t(90),N=t(261),k=t(429),O=t(262),S=t(249),_=t(953),j=t(307),x=t(237),w=t(11),C=t(22),A=function(e){Object(d.a)(t,e);var a=Object(u.a)(t);function t(e){var n;return Object(r.a)(this,t),(n=a.call(this,e)).state={id:"",schedule_id:"",data:{name:"",phone:"",email:"",cpf:"",profile:{name:""},schedules:[]},modalOpen:!1,user_id:"",filial_id:"",date:"",obs:"",filiais:[],users:[],loading:!1,states:[{value:"scheduled",label:"Agendado"},{value:"canceled",label:"Cancelado"},{value:"realized",label:"Realizado"}]},n.loadData=n.loadData.bind(Object(o.a)(n)),n.toggle=n.toggle.bind(Object(o.a)(n)),n.loadUsers=n.loadUsers.bind(Object(o.a)(n)),n.loadFiliais=n.loadFiliais.bind(Object(o.a)(n)),n.handleSchedule=n.handleSchedule.bind(Object(o.a)(n)),n.handleScheduleSave=n.handleScheduleSave.bind(Object(o.a)(n)),n}return Object(c.a)(t,[{key:"loadData",value:function(){var e=Object(i.a)(l.a.mark((function e(){var a,t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.props.match.params.id,e.next=3,x.a.get("crm/clients/".concat(a));case 3:t=e.sent,n=t.data,this.setState({data:n,id:a});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggle",value:function(){this.setState((function(e){return{modalOpen:!e.modalOpen}}))}},{key:"loadUsers",value:function(){var e=Object(i.a)(l.a.mark((function e(){var a,t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("users/");case 2:a=e.sent,t=a.data,this.setState({users:t.map((function(e){return{value:e.id,label:e.name}}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadFiliais",value:function(){var e=Object(i.a)(l.a.mark((function e(){var a,t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.get("filiais/");case 2:a=e.sent,t=a.data,this.setState({filiais:t.map((function(e){return{value:e.id,label:e.name}}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSchedule",value:function(e){var a,t,n=this.props.addToast;if("canceled"===e.state||"rescheduled"===e.state)return n({title:"Aten\xe7\xe3o!",content:"N\xe3o \xe9 possivel editar agedamentos cancelados e/ou reagendados.",time:new Date,duration:1e4,color:"info"}),!1;var s={value:null===e||void 0===e?void 0:e.user_id,label:null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.name},l=e.client_id,i={value:null===e||void 0===e?void 0:e.filial_id,label:null===e||void 0===e||null===(t=e.filial)||void 0===t?void 0:t.name},r=this.state.states.find((function(a){return a.value===e.state})),c=Object(_.a)(Object(j.a)(e.date),"yyyy'-'MM'-'dd'T'HH:mm");this.setState({schedule_id:e.id,user_id:s,client_id:l,filial_id:i,date:c,obs:e.obs,state:r}),this.toggle()}},{key:"handleScheduleSave",value:function(){var e=Object(i.a)(l.a.mark((function e(a){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t=this.props.addToast,this.state.date&&this.state.filial_id&&this.state.user_id){e.next=5;break}return alert("Os campos DATA, FILIAL E ATENDENTE s\xe3o obrigat\xf3rios."),e.abrupt("return",!1);case 5:return e.prev=5,this.setState({loading:!0}),e.next=9,x.a.put("/crm/schedules/".concat(this.state.schedule_id),{client_id:this.state.id,user_id:this.state.user_id.value,filial_id:this.state.filial_id.value,date:this.state.date,obs:this.state.obs,state:this.state.state.value});case 9:n=e.sent,n.data,this.toggle(),t({title:"Sucesso!.",content:"Agendamento atualizado com sucesso.",time:new Date,duration:1e4,color:"success"}),this.loadData(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),e.t0.response&&e.t0.response.data&&!0===e.t0.response.data.error?alert(e.t0.response.data.more):alert("Erro ao atualizado agendamento"),console.log(e.t0);case 20:this.setState({loading:!1});case 21:case"end":return e.stop()}}),e,this,[[5,16]])})));return function(a){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.loadData(),this.loadUsers(),this.loadFiliais()}},{key:"render",value:function(){var e=this,a={control:function(e,a){return Object(n.a)(Object(n.a)({},e),{},{borderColor:a.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0","&:hover":{borderColor:a.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0"},boxShadow:a.isFocused?"0 0 0 0.2rem rgba(114, 94, 195, 0.2)":""})},option:function(e,a){var t="";return a.isSelected?t="#725ec3":a.isFocused&&(t="rgba(114, 94, 195, 0.2)"),Object(n.a)(Object(n.a)({},e),{},{backgroundColor:t})},multiValueLabel:function(e){return Object(n.a)(Object(n.a)({},e),{},{color:"#545b61",backgroundColor:"#eeeeef"})}};return h.a.createElement(m.Fragment,null,h.a.createElement("div",{className:"rui-profile row vertical-gap"},h.a.createElement("div",{className:"col-lg-6 col-xl-5"},h.a.createElement("div",{className:"card"},h.a.createElement("div",{className:"card-body"},h.a.createElement("div",{className:"row vertical-gap"},h.a.createElement("div",{className:"col"},h.a.createElement("div",{className:"rui-profile-info"},h.a.createElement("h3",{className:"rui-profile-info-title h4"},this.state.data.name),h.a.createElement("small",{className:"text-grey-6 mt-2 mb-15"},this.state.data.cpf),h.a.createElement(b.b,{className:"rui-profile-info-mail",to:"mailto:".concat(this.state.data.email)},this.state.data.email),h.a.createElement(b.b,{className:"rui-profile-info-phone",to:"tel:".concat(this.state.data.phone)},this.state.data.phone))))))),h.a.createElement("div",{className:"col-lg-6 col-xl-7"},h.a.createElement("div",{className:"card"},h.a.createElement("div",{className:"card-body"},h.a.createElement("div",{className:"d-flex align-items-center"},h.a.createElement("h2",{className:"card-title mnb-6 mr-auto"},"Agendamentos"),h.a.createElement(b.b,{to:"/crm/clientes/".concat(this.state.id,"/calendario")},h.a.createElement("button",{className:"btn btn-brand btn-uniform btn-round btn-sm mnt-8 mnb-8",type:"button"},h.a.createElement(w.a,{name:"calendar"})))),h.a.createElement("ul",{className:"list-group list-group-flush rui-profile-task-list"},this.state.data.schedules.map((function(a){var t;return h.a.createElement("li",{className:"list-group-item",key:a.id,onClick:function(){return e.handleSchedule(a)}},h.a.createElement("div",{className:"rui-task rui-task-".concat(a.state)},h.a.createElement("div",{className:"rui-task-icon"},h.a.createElement(w.a,{name:D(a.state)})),h.a.createElement("div",{className:"rui-task-content"},h.a.createElement("a",{className:"rui-task-title"},Object(_.a)(Object(j.a)(a.date),"dd'/'MM'/'yyyy' \xe0s 'HH:mm'h'")),h.a.createElement("small",{className:"rui-task-subtitle"},"Atendente:"," ",h.a.createElement("a",null,h.a.createElement("strong",null,null===a||void 0===a||null===(t=a.user)||void 0===t?void 0:t.name))),h.a.createElement("small",{className:"rui-task-subtitle"},"Filial:"," ",h.a.createElement("a",null,h.a.createElement("strong",null,a.filial.name))," ","/ Situa\xe7\xe3o:"," ",h.a.createElement("a",null,h.a.createElement("strong",null,function(e){if("scheduled"===e)return"Agendado";if("canceled"===e)return"Cancelado";if("realized"===e)return"Realizado/Atendido";if("rescheduled"===e)return"Reagendado"}(a.state)))),h.a.createElement("small",{className:"rui-task-subtitle"},"Obs:"," ",h.a.createElement("a",null,h.a.createElement("strong",null,a.obs))))))}))))))),h.a.createElement(v.a,{isOpen:this.state.modalOpen,toggle:this.toggle,className:this.props.className,fade:!0},h.a.createElement("form",{onSubmit:this.handleScheduleSave},h.a.createElement("div",{className:"modal-header"},h.a.createElement("h5",{className:"modal-title h2"},"Editar Agendamento"),h.a.createElement(y.a,{className:"close",color:"",onClick:this.toggle},h.a.createElement(w.a,{name:"x"}))),h.a.createElement(E.a,null,"Editar agendamento para ",h.a.createElement("mark",{className:"display-4"},this.state.data.name),h.a.createElement("br",null),h.a.createElement("br",null),h.a.createElement(N.a,null,h.a.createElement(k.a,{for:"state"},"Situa\xe7\xe3o *"),h.a.createElement(S.a,{id:"state",name:"state",required:!0,defaultValue:this.state.state,options:this.state.states,styles:a,onChange:function(a){return e.setState({state:a})}})),h.a.createElement(N.a,null,h.a.createElement(k.a,{for:"filial_id"},"Filial *"),h.a.createElement(S.a,{id:"filial_id",name:"filial_id",required:!0,defaultValue:this.state.filial_id,options:this.state.filiais,styles:a,onChange:function(a){return e.setState({filial_id:a})}})),h.a.createElement(N.a,null,h.a.createElement(k.a,{for:"user_id"},"Atendente *"),h.a.createElement(S.a,{id:"user_id",name:"user_id",required:!0,defaultValue:this.state.user_id,options:this.state.users,styles:a,onChange:function(a){return e.setState({user_id:a})}})),h.a.createElement(N.a,null,h.a.createElement(k.a,{for:"date"},"Data e Hora *"),h.a.createElement(O.a,{id:"date",name:"date",required:!0,min:new Date,placeholder:"01/01/2021",type:"datetime-local",value:this.state.date,onChange:function(a){return e.setState({date:a.target.value})}})),h.a.createElement(N.a,null,h.a.createElement(k.a,{for:"obs"},"Observa\xe7\xf5es"),h.a.createElement(O.a,{id:"obs",name:"obs",placeholder:"",type:"text",value:this.state.obs,onChange:function(a){return e.setState({obs:a.target.value})}}))),h.a.createElement(g.a,null,h.a.createElement(y.a,{color:"secondary",type:"button",onClick:this.toggle,disabled:this.state.loading},"Fechar")," ",h.a.createElement(y.a,{color:"success",type:"submit",disabled:this.state.loading},this.state.loading?"Salvando...":"Salvar")))))}}]),t}(m.Component);function D(e){return"scheduled"===e?"calendar":"canceled"===e?"x-square":"realized"===e?"check-square":"rescheduled"===e?"copy":void 0}a.default=Object(f.b)((function(e){return{settings:e.settings,toasts:e.toasts}}),{addToast:C.e,removeToast:C.f})(Object(p.f)(A))}}]);
//# sourceMappingURL=50.c6c4f879.chunk.js.map