(this.webpackJsonpOnb=this.webpackJsonpOnb||[]).push([[46],{236:function(e,a,t){"use strict";var n=t(241),r=t.n(n),l=t(18),s=t.n(l),i=r.a.create({baseURL:"http://onb-api-demo.agenciaonside.com.br"});i.interceptors.request.use((function(e){return e.headers.Authorization="bearer "+s.a.get("rui-auth-token"),e}),(function(e){Promise.reject(e)})),a.a=i},570:function(e,a,t){},677:function(e,a,t){"use strict";t.r(a);var n=t(21),r=t(239),l=t.n(r),s=t(240),i=t(2),c=t(3),o=t(14),u=t(5),m=t(4),d=(t(70),t(0)),h=t.n(d),p=t(26),f=t(10),b=t(23),v=t(268),E=t(266),g=t(267),N=t(90),O=t(275),y=t(274),k=t(276),S=t(243),w=t(236),j=t(11);t(570);window.jQuery.DataTable=t(571);var _=function(e){Object(u.a)(t,e);var a=Object(m.a)(t);function t(e){var n;return Object(i.a)(this,t),(n=a.call(this,e)).ref=Object(d.createRef)(),n}return Object(c.a)(t,[{key:"componentDidMount",value:function(){if(this.ref){var e=this.props.data;window.jQuery(this.ref.current).DataTable(e)}}},{key:"shouldComponentUpdate",value:function(){if(this.ref){var e=this.props.data;return window.jQuery(this.ref.current).DataTable(Object(n.a)({retrieve:!0},e)),!0}}},{key:"componentWillUnmount",value:function(){this.ref&&window.jQuery(this.ref.current).DataTable().destroy(!0)}},{key:"render",value:function(){var e=this.props,a=e.className,t=e.children;return h.a.createElement("table",{className:a,ref:this.ref},t)}}]),t}(d.Component),D=t(22),A=function(e){Object(u.a)(t,e);var a=Object(m.a)(t);function t(e){var n;return Object(i.a)(this,t),(n=a.call(this,e)).state={term:"",data:[],modalOpen:!1,client_id:"",client_name:"",user_id:"",filial_id:"",date:"",obs:"",filiais:[],users:[],loading:!1},n.toggle=n.toggle.bind(Object(o.a)(n)),n.handleSchedule=n.handleSchedule.bind(Object(o.a)(n)),n.handleScheduleSave=n.handleScheduleSave.bind(Object(o.a)(n)),n.loadUsers=n.loadUsers.bind(Object(o.a)(n)),n.loadData=n.loadData.bind(Object(o.a)(n)),n.loadFiliais=n.loadFiliais.bind(Object(o.a)(n)),n}return Object(c.a)(t,[{key:"toggle",value:function(){this.setState((function(e){return{modalOpen:!e.modalOpen}}))}},{key:"loadData",value:function(){var e=Object(s.a)(l.a.mark((function e(){var a,t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get("crm/clients");case 2:a=e.sent,t=a.data,this.setState({data:t.map((function(e){return e.is_active=e.is_active?"Ativo":"Inativo",e.qtde_sales=e.qtde_sales?e.qtde_sales:0,e.phone=e.phone?e.phone:"-",e.email=e.email?e.email:"-",e}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadUsers",value:function(){var e=Object(s.a)(l.a.mark((function e(){var a,t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get("users/");case 2:a=e.sent,t=a.data,this.setState({users:t.map((function(e){return{value:e.id,label:e.name}}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadFiliais",value:function(){var e=Object(s.a)(l.a.mark((function e(){var a,t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.a.get("filiais/");case 2:a=e.sent,t=a.data,this.setState({filiais:t.map((function(e){return{value:e.id,label:e.name}}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSchedule",value:function(e,a){this.setState({client_id:e,client_name:a}),this.toggle()}},{key:"handleScheduleSave",value:function(){var e=Object(s.a)(l.a.mark((function e(a){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a.preventDefault(),t=this.props.addToast,this.state.date&&this.state.filial_id&&this.state.user_id){e.next=5;break}return alert("Os campos DATA, FILIAL E ATENDENTE s\xe3o obrigat\xf3rios."),e.abrupt("return",!1);case 5:return e.prev=5,this.setState({loading:!0}),e.next=9,w.a.post("/crm/clients/".concat(this.state.client_id,"/schedules"),{user_id:this.state.user_id.value,filial_id:this.state.filial_id.value,date:this.state.date,obs:this.state.obs});case 9:n=e.sent,n.data,this.toggle(),t({title:"Sucesso!.",content:"Agendamento realizado com sucesso.",time:new Date,duration:1e4,color:"success"}),e.next=19;break;case 15:e.prev=15,e.t0=e.catch(5),e.t0.response&&e.t0.response.data&&!0===e.t0.response.data.error?alert(e.t0.response.data.more):alert("Erro ao criar agendamento"),console.log(e.t0);case 19:this.setState({loading:!1});case 20:case"end":return e.stop()}}),e,this,[[5,15]])})));return function(a){return e.apply(this,arguments)}}()},{key:"handleChangeStatus",value:function(){var e=Object(s.a)(l.a.mark((function e(a,t){var n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.addToast,e.prev=1,this.setState({loading:!0}),e.next=5,w.a.put("/crm/clients/".concat(a),{is_active:"Ativo"!==t});case 5:r=e.sent,r.data,n({title:"Sucesso!.",content:"O registro foi ".concat("Ativo"===t?"Desativado":"Ativado"," com sucesso"),time:new Date,duration:1e4,color:"success"}),this.loadData(),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(1),e.t0.response&&e.t0.response.data&&!0===e.t0.response.data.error?alert(e.t0.response.data.more):alert("Erro ao tentar alterar situa\xe7\xe3o"),console.log(e.t0);case 15:this.setState({loading:!1});case 16:case"end":return e.stop()}}),e,this,[[1,11]])})));return function(a,t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.loadData(),this.loadUsers(),this.loadFiliais()}},{key:"render",value:function(){var e=this,a=this.state.term,t={control:function(e,a){return Object(n.a)(Object(n.a)({},e),{},{borderColor:a.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0","&:hover":{borderColor:a.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0"},boxShadow:a.isFocused?"0 0 0 0.2rem rgba(114, 94, 195, 0.2)":""})},option:function(e,a){var t="";return a.isSelected?t="#725ec3":a.isFocused&&(t="rgba(114, 94, 195, 0.2)"),Object(n.a)(Object(n.a)({},e),{},{backgroundColor:t})},multiValueLabel:function(e){return Object(n.a)(Object(n.a)({},e),{},{color:"#545b61",backgroundColor:"#eeeeef"})}};return h.a.createElement(d.Fragment,null,h.a.createElement("div",{className:"rui-filemanager"},h.a.createElement("div",{className:"rui-filemanager-head"},h.a.createElement("div",{className:"row sm-gap vertical-gap align-items-center"},h.a.createElement("div",{className:"col"},h.a.createElement("div",{className:"input-group"},h.a.createElement("div",{className:"input-group-prepend mnl-3"},h.a.createElement("button",{type:"button",className:"btn btn-clean btn-grey-5 mb-0 mnl-10"},h.a.createElement(j.a,{name:"search"}))),h.a.createElement("input",{type:"search",value:a,onChange:function(a){return e.setState({term:a.target.value})},placeholder:"Digite aqui para pesquisar...",className:"form-control form-control-clean rui-search-input"}))),h.a.createElement("div",{className:"col-auto"},h.a.createElement(f.b,{to:"/crm/clientes/add"},h.a.createElement("button",{type:"button",className:"btn btn-brand btn-sm btn-uniform btn-round"},h.a.createElement(j.a,{name:"plus"})))))),h.a.createElement("div",{className:"rui-filemanager-content"},h.a.createElement("div",{className:"table-responsive-lg"},this.state.data.length>0?h.a.createElement(_,{className:"rui-datatable rui-filemanager-table table mb-0 ",data:{order:[0,"asc"],paging:!1,info:!1,searching:!1}},h.a.createElement("thead",null,h.a.createElement("tr",null,h.a.createElement("th",{scope:"col"},"Nome",h.a.createElement(j.a,{name:"chevron-down"})),h.a.createElement("th",{scope:"col"},"Telefone",h.a.createElement(j.a,{name:"chevron-down"})),h.a.createElement("th",{scope:"col"},"Situa\xe7\xe3o",h.a.createElement(j.a,{name:"chevron-down"})),h.a.createElement("th",{scope:"col"},"Atendimentos",h.a.createElement(j.a,{name:"chevron-down"})),h.a.createElement("th",{className:"rui-datatable-empty"}))),h.a.createElement("tbody",null,this.state.data.map((function(t){if(""===a||t.name.toUpperCase().includes(a.toUpperCase()))return h.a.createElement("tr",null,h.a.createElement("th",{scope:"row",className:"rui-filemanager-table-name"},h.a.createElement("span",{className:"rui-filemanager-file"},h.a.createElement(f.b,{className:"rui-filemanager-file-link",to:"/crm/clientes/show/".concat(t.id)},t.name))),h.a.createElement("td",{className:"rui-filemanager-table-date"},h.a.createElement("a",{className:"rui-filemanager-file-a",href:"tel:".concat(t.phone)},h.a.createElement("span",{className:"rui-filemanager-file"},t.phone))),h.a.createElement("td",{className:"rui-filemanager-table-size"},h.a.createElement("span",{className:"rui-filemanager-file"},t.is_active)),h.a.createElement("td",{className:"rui-filemanager-table-size"},h.a.createElement("span",{className:"rui-filemanager-file"},t.qtde_sales)),h.a.createElement("td",{className:"rui-filemanager-table-icon"},h.a.createElement("span",{className:"rui-filemanager-file d-flex"},h.a.createElement(f.b,{className:"rui-filemanager-file-icon mr-10",to:"/crm/clientes/edit/".concat(t.id)},h.a.createElement(j.a,{name:"edit"})),h.a.createElement(b.a,{tag:"a",direction:"left",className:""},h.a.createElement(b.a.Toggle,{tag:"a",className:"dropdown-item "},h.a.createElement(j.a,{name:"more-vertical"})),h.a.createElement(b.a.Menu,{tag:"ul",className:"nav"},h.a.createElement("li",null,h.a.createElement("a",{className:"nav-link",onClick:function(){return e.handleSchedule(t.id,t.name)}},h.a.createElement(j.a,{name:"calendar"}),h.a.createElement("span",null,"Realizar Agendamento"),h.a.createElement("span",{className:"rui-nav-circle"}))),h.a.createElement("li",null,h.a.createElement(f.b,{to:"/crm/clientes/".concat(t.id,"/agendamentos"),className:"nav-link"},h.a.createElement(j.a,{name:"calendar"}),h.a.createElement("span",null,"Ver Agendamentos"),h.a.createElement("span",{className:"rui-nav-circle"}))),h.a.createElement("li",null,h.a.createElement(f.b,{to:"/crm/clientes/show/".concat(t.id,"/"),className:"nav-link"},h.a.createElement(j.a,{name:"file-text"}),h.a.createElement("span",null,"Hist\xf3rico de Atendimentos"),h.a.createElement("span",{className:"rui-nav-circle"}))),h.a.createElement("li",null,h.a.createElement("a",{className:"nav-link",onClick:function(){return e.handleChangeStatus(t.id,t.is_active)}},h.a.createElement(j.a,{name:"refresh-cw"}),h.a.createElement("span",null,e.state.loading?"Alterando...":"Ativar/Desativar"),h.a.createElement("span",{className:"rui-nav-circle"}))))))))})))):h.a.createElement(h.a.Fragment,null)))),h.a.createElement(v.a,{isOpen:this.state.modalOpen,toggle:this.toggle,className:this.props.className,fade:!0},h.a.createElement("form",{onSubmit:this.handleScheduleSave},h.a.createElement("div",{className:"modal-header"},h.a.createElement("h5",{className:"modal-title h2"},"Agendar Atendimento"),h.a.createElement(N.a,{className:"close",color:"",onClick:this.toggle},h.a.createElement(j.a,{name:"x"}))),h.a.createElement(E.a,null,"Realizar agendamento para ",h.a.createElement("mark",{className:"display-4"},this.state.client_name),h.a.createElement("br",null),h.a.createElement("br",null),h.a.createElement(O.a,null,h.a.createElement(y.a,{for:"filial_id"},"Filial *"),h.a.createElement(S.a,{id:"filial_id",name:"filial_id",required:!0,defaultValue:this.state.filial_id,options:this.state.filiais,styles:t,onChange:function(a){return e.setState({filial_id:a})}})),h.a.createElement(O.a,null,h.a.createElement(y.a,{for:"user_id"},"Atendente *"),h.a.createElement(S.a,{id:"user_id",name:"user_id",required:!0,defaultValue:this.state.user_id,options:this.state.users,styles:t,onChange:function(a){return e.setState({user_id:a})}})),h.a.createElement(O.a,null,h.a.createElement(y.a,{for:"date"},"Data e Hora *"),h.a.createElement(k.a,{id:"date",name:"date",required:!0,min:new Date,placeholder:"01/01/2021",type:"datetime-local",value:this.state.date,onChange:function(a){return e.setState({date:a.target.value})}})),h.a.createElement(O.a,null,h.a.createElement(y.a,{for:"obs"},"Observa\xe7\xf5es"),h.a.createElement(k.a,{id:"obs",name:"obs",placeholder:"",type:"text",value:this.state.obs,onChange:function(a){return e.setState({obs:a.target.value})}}))),h.a.createElement(g.a,null,h.a.createElement(N.a,{color:"secondary",type:"button",onClick:this.toggle,disabled:this.state.loading},"Fechar")," ",h.a.createElement(N.a,{color:"success",type:"submit",disabled:this.state.loading},this.state.loading?"Salvando...":"Agendar")))))}}]),t}(d.Component);a.default=Object(p.b)((function(e){return{settings:e.settings,toasts:e.toasts}}),{addToast:D.e,removeToast:D.f})(A)}}]);
//# sourceMappingURL=46.8e47d907.chunk.js.map