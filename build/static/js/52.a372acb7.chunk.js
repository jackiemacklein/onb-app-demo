(this["webpackJsonponb-app-demo.agenciaonside.com.br"]=this["webpackJsonponb-app-demo.agenciaonside.com.br"]||[]).push([[52],{237:function(e,t,a){"use strict";var n=a(246),l=a.n(n),i=a(18),r=a.n(i),s=l.a.create({baseURL:"https://onb-api-demo.agenciaonside.com.br"});s.interceptors.request.use((function(e){return e.headers.Authorization="bearer "+r.a.get("rui-auth-token"),e}),(function(e){Promise.reject(e)})),t.a=s},307:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var n=a(278),l=a(255),i={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,c=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(e,t){Object(l.a)(1,arguments);var a=t||{},i=null==a.additionalDigits?2:Object(n.a)(a.additionalDigits);if(2!==i&&1!==i&&0!==i)throw new RangeError("additionalDigits must be 0, 1 or 2");if("string"!==typeof e&&"[object String]"!==Object.prototype.toString.call(e))return new Date(NaN);var r,s=d(e);if(s.date){var c=m(s.date,i);r=u(c.restDateString,c.year)}if(isNaN(r)||!r)return new Date(NaN);var o,p=r.getTime(),v=0;if(s.time&&(v=h(s.time),isNaN(v)||null===v))return new Date(NaN);if(!s.timezone){var _=new Date(p+v),E=new Date(_.getUTCFullYear(),_.getUTCMonth(),_.getUTCDate(),_.getUTCHours(),_.getUTCMinutes(),_.getUTCSeconds(),_.getUTCMilliseconds());return E.setFullYear(_.getUTCFullYear()),E}return o=g(s.timezone),isNaN(o)?new Date(NaN):new Date(p+v+o)}function d(e){var t,a={},n=e.split(i.dateTimeDelimiter);if(n.length>2)return a;if(/:/.test(n[0])?(a.date=null,t=n[0]):(a.date=n[0],t=n[1],i.timeZoneDelimiter.test(a.date)&&(a.date=e.split(i.timeZoneDelimiter)[0],t=e.substr(a.date.length,e.length))),t){var l=i.timezone.exec(t);l?(a.time=t.replace(l[1],""),a.timezone=l[1]):a.time=t}return a}function m(e,t){var a=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),n=e.match(a);if(!n)return{year:null};var l=n[1]&&parseInt(n[1]),i=n[2]&&parseInt(n[2]);return{year:null==i?l:100*i,restDateString:e.slice((n[1]||n[2]).length)}}function u(e,t){if(null===t)return null;var a=e.match(r);if(!a)return null;var n=!!a[4],l=p(a[1]),i=p(a[2])-1,s=p(a[3]),c=p(a[4]),o=p(a[5])-1;if(n)return function(e,t,a){return t>=1&&t<=53&&a>=0&&a<=6}(0,c,o)?function(e,t,a){var n=new Date(0);n.setUTCFullYear(e,0,4);var l=n.getUTCDay()||7,i=7*(t-1)+a+1-l;return n.setUTCDate(n.getUTCDate()+i),n}(t,c,o):new Date(NaN);var d=new Date(0);return function(e,t,a){return t>=0&&t<=11&&a>=1&&a<=(_[t]||(E(e)?29:28))}(t,i,s)&&function(e,t){return t>=1&&t<=(E(e)?366:365)}(t,l)?(d.setUTCFullYear(t,i,Math.max(l,s)),d):new Date(NaN)}function p(e){return e?parseInt(e):1}function h(e){var t=e.match(s);if(!t)return null;var a=v(t[1]),n=v(t[2]),l=v(t[3]);return function(e,t,a){if(24===e)return 0===t&&0===a;return a>=0&&a<60&&t>=0&&t<60&&e>=0&&e<25}(a,n,l)?36e5*a+6e4*n+1e3*l:NaN}function v(e){return e&&parseFloat(e.replace(",","."))||0}function g(e){if("Z"===e)return 0;var t=e.match(c);if(!t)return 0;var a="+"===t[1]?-1:1,n=parseInt(t[2]),l=t[3]&&parseInt(t[3])||0;return function(e,t){return t>=0&&t<=59}(0,l)?a*(36e5*n+6e4*l):NaN}var _=[31,null,31,30,31,30,31,31,30,31,30,31];function E(e){return e%400===0||e%4===0&&e%100}},916:function(e,t,a){"use strict";a.r(t);var n=a(244),l=a.n(n),i=a(245),r=a(2),s=a(3),c=a(14),o=a(5),d=a(4),m=a(0),u=a.n(m),p=a(26),h=a(19),v=a(10),g=a(90),_=a(261),E=a(429),f=a(262),b=a(353),y=a(346),N=a(347),k=(a(699),a(11)),S=a(237),O=a(953),C=a(307),w=a(22),x=function(e){Object(o.a)(a,e);var t=Object(d.a)(a);function a(e){var n;return Object(r.a)(this,a),(n=t.call(this,e)).state={modalNewClientOpen:!1,modalEditOpen:!1,modalPaymentOpen:!1,inputValue:"",data:{},payment_methods:[],updateValues:!1,cancelPassword:"",canceling:!1,paying:!1,payment_method_text:"",payment_method_id:"",coupon:"",item_edit_id:"",item_edit_name:"",item_edit_count:"",item_edit_stock:"",item_edit_value:0,item_edit_discount_amount:0,item_edit_discount_percentage:0,item_edit_maximum_discount:0,item_edit_amount:0,item_edit_type:0,client_id:{},client_name:"",client_phone:"",client_cpf:"",client_email:"",loading:!1},n.loadData=n.loadData.bind(Object(c.a)(n)),n.getState=n.getState.bind(Object(c.a)(n)),n.getColor=n.getColor.bind(Object(c.a)(n)),n.handleCancelSaleCart=n.handleCancelSaleCart.bind(Object(c.a)(n)),n.toggleModalCancelOpen=n.toggleModalCancelOpen.bind(Object(c.a)(n)),n.toggleModalEditOpen=n.toggleModalEditOpen.bind(Object(c.a)(n)),n.handleEditProductInSale=n.handleEditProductInSale.bind(Object(c.a)(n)),n.handleEditServiceInSale=n.handleEditServiceInSale.bind(Object(c.a)(n)),n}return Object(s.a)(a,[{key:"loadData",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t,a,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.prev=1,e.next=4,S.a.get("/sales/".concat(t));case 4:a=e.sent,n=a.data,this.setState({data:n}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0);case 12:case"end":return e.stop()}}),e,this,[[1,9]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleCancelSaleCart",value:function(){var e=Object(i.a)(l.a.mark((function e(){var t,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props,a=t.addToast,t.history,this.state.cancelPassword){e.next=5;break}return this.toggleModalCancelOpen(),a({title:"Digite a Senha",content:"Por favor, informe sua senha de acesso.",time:new Date,duration:12e3,color:"warning"}),e.abrupt("return",!1);case 5:return this.setState({canceling:!0}),e.prev=6,e.next=9,S.a.post("/sale/cancel/".concat(this.state.data.id),{password:this.state.cancelPassword});case 9:a({title:"Sucesso!",content:"Venda/Servi\xe7o Cancelada(o) com sucesso.",time:new Date,duration:12e3,color:"success"}),this.loadData(),e.next=18;break;case 13:e.prev=13,e.t0=e.catch(6),e.t0.response?e.t0.response.status&&401==e.t0.response.status&&a({title:"Acesso Negado!",content:"Desculpe, n\xe3o foi possivel cancelar a(o) venda/servico!",time:new Date,duration:12e3,color:"warning"}):a({title:"Erro desconhecido!",content:"Desculpe, Tente novamente",time:new Date,duration:12e3,color:"error"}),this.setState({cancelPassword:"",canceling:!1}),this.toggleModalCancelOpen();case 18:case"end":return e.stop()}}),e,this,[[6,13]])})));return function(){return e.apply(this,arguments)}}()},{key:"handleEditProductInSale",value:function(){var e=Object(i.a)(l.a.mark((function e(t){var a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({item_edit_type:"products"}),this.state.data.products.map((function(e){if(e.product_id===t){var n,l,i,r=a.state.data.additionals.products.find((function(t){return t.id===e.product_id}));r.virtual_stock?r.virtual_stock=r.virtual_stock:r.virtual_stock=r.stock-e.count,a.setState({item_edit_id:e.product_id}),a.setState({item_edit_name:"".concat(e.product.name," (R$ ").concat(e.unit_value.toFixed(2).toLocaleString(),")")}),a.setState({item_edit_count:e.count}),a.setState({item_edit_stock:r.virtual_stock}),a.setState({item_edit_value:e.unit_value}),a.setState({item_edit_discount_amount:null!==(n=e.discount_amount)&&void 0!==n?n:0}),a.setState({item_edit_discount_percentage:null!==(l=e.discount_percentage)&&void 0!==l?l:0}),a.setState({item_edit_maximum_discount:null!==(i=e.product.maximum_discount)&&void 0!==i?i:0}),a.setState({item_edit_amount:e.amount})}})),this.toggleModalEditOpen();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"handleEditServiceInSale",value:function(){var e=Object(i.a)(l.a.mark((function e(t){var a=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({item_edit_type:"services"}),this.state.data.services.map((function(e){var n,l,i;e.service_id===t&&(a.setState({item_edit_id:e.service_id}),a.setState({item_edit_name:"".concat(e.service.name," (R$ ").concat(null===(n=e.unit_value)||void 0===n?void 0:n.toLocaleString(),")")}),a.setState({item_edit_count:e.count}),a.setState({item_edit_stock:1e7}),a.setState({item_edit_value:e.unit_value}),a.setState({item_edit_discount_amount:null!==(l=e.discount_amount)&&void 0!==l?l:0}),a.setState({item_edit_discount_percentage:null!==(i=e.discount_percentage)&&void 0!==i?i:0}),a.setState({item_edit_maximum_discount:100}),a.setState({item_edit_amount:e.amount}))})),this.toggleModalEditOpen();case 3:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getState",value:function(e){switch(e){case"open":return"Aberta";case"closed":return"Fechada";case"canceled":return"Cancelada"}}},{key:"getColor",value:function(e){switch(e){case"open":return"warning";case"closed":return"success";case"canceled":return"danger"}}},{key:"toggleModalCancelOpen",value:function(){this.setState((function(e){return{modalCancelOpen:!e.modalCancelOpen}}))}},{key:"toggleModalEditOpen",value:function(){this.setState((function(e){return{modalEditOpen:!e.modalEditOpen}}))}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"componentDidUpdate",value:function(e,t){}},{key:"render",value:function(){var e,t,a,n,l,i,r,s,c,o,d,p,h,S,w,x,D,j,F,M,T,U,I,P,$,R,L,z,H,Z,V=this;return u.a.createElement(m.Fragment,null,u.a.createElement("div",{className:"row vertical-gap"},u.a.createElement("div",{className:"col-lg-6 order-lg-12 rui-task-sidebar order-1"},u.a.createElement("div",{className:"card card-border-effect-kie"},u.a.createElement("div",{className:"card-body py-30"},u.a.createElement("ul",{className:"list-group list-group-flush rui-task-sidebar-list"},u.a.createElement("li",{className:"list-group-item"},u.a.createElement("ul",{className:"list-unstyled rui-task-info-list"},null===(e=this.state.data)||void 0===e||null===(t=e.services)||void 0===t?void 0:t.map((function(e){var t;return u.a.createElement("li",{key:e.id,onClick:function(){return V.handleEditServiceInSale(e.service.id)}},u.a.createElement("div",{className:"rui-task-info-item"},u.a.createElement(k.a,{name:"eye",className:"mr-5"}),u.a.createElement("h6",{className:"h6 rui-task-sidebar-title text-right mb-0 mt-0"},u.a.createElement("strong",null,"x",e.count)," -"),u.a.createElement("span",{className:"list-items-sale"},e.service.name),u.a.createElement("h6",{className:"h6 rui-task-sidebar-title text-right mb-0 mt-0"},u.a.createElement("strong",null,"R$ ",null===(t=e.amount)||void 0===t?void 0:t.toFixed(2).toLocaleString()))))})),null===(a=this.state.data)||void 0===a||null===(n=a.products)||void 0===n?void 0:n.map((function(e){var t;return u.a.createElement("li",{key:e.product.id,onClick:function(){return V.handleEditProductInSale(e.product.id)}},u.a.createElement("div",{className:"rui-task-info-item"},u.a.createElement(k.a,{name:"eye",className:"mr-5"}),u.a.createElement("h6",{className:"h6 rui-task-sidebar-title text-right mb-0 mt-0"},u.a.createElement("strong",null,"x",e.count)," -"),u.a.createElement("span",{className:"list-items-sale"},e.product.name),u.a.createElement("h6",{className:"h6 rui-task-sidebar-title text-right mb-0 mt-0"},u.a.createElement("strong",null,"R$ ",null===(t=e.amount)||void 0===t?void 0:t.toFixed(2).toLocaleString()))))})))),u.a.createElement("li",{className:"list-group-item"},u.a.createElement("h5",{className:"h4 rui-task-sidebar-title text-right mb-0 mt-0"},u.a.createElement("strong",null,"R$ ",null===(l=this.state.data)||void 0===l||null===(i=l.amount)||void 0===i?void 0:i.toFixed(2).toLocaleString()))),u.a.createElement("li",{className:"list-group-item"},u.a.createElement("h5",{className:"h4 rui-task-sidebar-title"},"Pago atrav\xe9s:"),u.a.createElement("ul",{className:"list-unstyled rui-task-project-list payment-types payment-by"},u.a.createElement("li",{className:"payment-type",style:{flex:1}},u.a.createElement(g.a,{block:!0,className:"btn-hover-outline text-center",color:null===(r=this.state)||void 0===r||null===(s=r.data)||void 0===s||null===(c=s.payment_method)||void 0===c?void 0:c.color},null===(o=this.state)||void 0===o||null===(d=o.data)||void 0===d||null===(p=d.payment_method)||void 0===p?void 0:p.name)),"canceled"!==this.state.data.state?u.a.createElement(u.a.Fragment,null,u.a.createElement("li",{className:"payment-type",style:{flex:1}},u.a.createElement(g.a,{block:!0,className:"btn-hover-outline text-center",color:"light",onClick:this.toggleModalCancelOpen},"Cancelar"))):u.a.createElement(u.a.Fragment,null))))))),u.a.createElement("div",{className:"col-lg-6 order-lg-0 order-0"},u.a.createElement("div",{className:"rui-task-comment"},u.a.createElement("div",{className:"media media-show"},u.a.createElement("div",{className:"rui-task-status rui-task-status-".concat(this.getColor(this.state.data.state))},u.a.createElement("div",{className:"row vertical-gap align-items-center sm-gap"},u.a.createElement("div",{className:"col-auto"},u.a.createElement("div",{className:"rui-task-status-item"},u.a.createElement("div",{className:"rui-task-status-item-icon"},u.a.createElement(k.a,{name:"check-circle"})),"closed"===this.state.data.state?u.a.createElement(u.a.Fragment,null,"Fechada em ",u.a.createElement("mark",null,this.state.data.updated_at?Object(O.a)(Object(C.a)(this.state.data.updated_at),"dd'/'MM'/'yyyy HH':'mm"):"")):u.a.createElement(u.a.Fragment,null,"canceled"===this.state.data.state?u.a.createElement(u.a.Fragment,null,"Cancelada em"," ",u.a.createElement("mark",null,this.state.data.updated_at?Object(O.a)(Object(C.a)(this.state.data.updated_at),"dd'/'MM'/'yyyy HH':'mm"):"")):u.a.createElement(u.a.Fragment,null,this.getState(this.state.data.state)," em"," ",u.a.createElement("mark",null,this.state.data.date?Object(O.a)(Object(C.a)(this.state.data.date),"dd'/'MM'/'yyyy HH':'mm"):""))))))),u.a.createElement("span",{className:"media-link sale-details"},u.a.createElement("span",{className:"media-body"},u.a.createElement("span",{className:"media-title"},"Aberta por:"," ",u.a.createElement("mark",null,u.a.createElement("strong",null,null===(h=this.state.data)||void 0===h||null===(S=h.user)||void 0===S?void 0:S.name))),"closed"===this.state.data.state?u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{className:"media-title"},"Fechada por:"," ",u.a.createElement("mark",null,u.a.createElement("strong",null,null===(w=this.state.data)||void 0===w||null===(x=w.closed_by)||void 0===x?void 0:x.name)))):u.a.createElement(u.a.Fragment,null,"canceled"===this.state.data.state?u.a.createElement(u.a.Fragment,null,u.a.createElement("span",{className:"media-title"},"Cancelada por:"," ",u.a.createElement("mark",null,u.a.createElement("strong",null,null===(D=this.state.data)||void 0===D||null===(j=D.canceled_by)||void 0===j?void 0:j.name)))):u.a.createElement(u.a.Fragment,null)),u.a.createElement("small",{className:"media-title"},"Cliente:"," ",u.a.createElement("mark",null,this.state.data.client_id?u.a.createElement(u.a.Fragment,null,u.a.createElement(v.b,{to:"/crm/clientes/show/".concat(this.state.data.client_id),target:"_blank"},u.a.createElement("strong",null,null!==(F=null===(M=this.state)||void 0===M||null===(T=M.data)||void 0===T||null===(U=T.client)||void 0===U?void 0:U.name)&&void 0!==F?F:null===(I=this.state)||void 0===I||null===(P=I.data)||void 0===P?void 0:P.client_name))):u.a.createElement(u.a.Fragment,null,u.a.createElement("strong",null,null!==($=null===(R=this.state)||void 0===R||null===(L=R.data)||void 0===L||null===(z=L.client)||void 0===z?void 0:z.name)&&void 0!==$?$:null===(H=this.state)||void 0===H||null===(Z=H.data)||void 0===Z?void 0:Z.client_name)))))))))),u.a.createElement(b.a,{isOpen:this.state.modalCancelOpen,toggle:this.toggleModalCancelOpen,className:this.props.className,fade:!0},u.a.createElement("div",{className:"modal-header"},u.a.createElement("h5",{className:"modal-title h2"},"Cancelar Venda/Servi\xe7o"),u.a.createElement(g.a,{className:"close",color:"",onClick:this.toggleModalCancelOpen},u.a.createElement(k.a,{name:"x"}))),u.a.createElement(y.a,null,"Tem Certeza que deseja cancelar a venda #",this.state.data.id,"? ",u.a.createElement("mark",null,"Todos os lan\xe7amentos e o fluxo de caixa ser\xe3o impactados."),u.a.createElement("br",null),u.a.createElement(_.a,null,u.a.createElement(E.a,{for:"password"},"Senha"),u.a.createElement(f.a,{id:"password",name:"password",placeholder:"***",type:"password",value:this.state.cancelPassword,onChange:function(e){return V.setState({cancelPassword:e.target.value})}}))),u.a.createElement(N.a,null,u.a.createElement(g.a,{color:"secondary",onClick:this.toggleModalCancelOpen},"Fechar")," ",u.a.createElement(g.a,{color:"brand",onClick:this.handleCancelSaleCart,disabled:this.state.canceling},this.state.canceling?"Cancelando...":"Cancelar"))),u.a.createElement(b.a,{isOpen:this.state.modalEditOpen,toggle:this.toggleModalEditOpen,className:this.props.className,fade:!0},u.a.createElement("div",{className:"modal-header"},u.a.createElement("h5",{className:"modal-title h2"},"Item da Venda/Servi\xe7o"),u.a.createElement(g.a,{className:"close",color:"",onClick:this.toggleModalEditOpen},u.a.createElement(k.a,{name:"x"}))),u.a.createElement(y.a,null,u.a.createElement("mark",{className:"display-4"},this.state.item_edit_name),u.a.createElement("br",null),u.a.createElement("br",null),u.a.createElement(_.a,null,u.a.createElement(E.a,{for:"count"},"Quantidade"),u.a.createElement(f.a,{id:"count",name:"count",placeholder:"count",type:"number",disabled:!0,readOnly:!0,value:this.state.item_edit_count})),u.a.createElement(_.a,null,u.a.createElement(E.a,{for:"discount_amount"},"R$ de Desconto"),u.a.createElement(f.a,{id:"discount_amount",name:"discount_amount",placeholder:"0,00",type:"text",disabled:!0,readOnly:!0,value:this.state.item_edit_discount_amount.toFixed(2).toLocaleString()})),u.a.createElement(_.a,null,u.a.createElement(E.a,{for:"item_edit_discount_percentage"},"% de Desconto"),u.a.createElement(f.a,{id:"item_edit_discount_percentage",name:"item_edit_discount_percentage",placeholder:"0,00",type:"text",disabled:!0,readOnly:!0,value:this.state.item_edit_discount_percentage.toFixed(2).toLocaleString()})),u.a.createElement(_.a,null,u.a.createElement(E.a,{for:"item_edit_amount"},"R$ Total"),u.a.createElement(f.a,{id:"item_edit_amount",disabled:!0,readOnly:!0,name:"item_edit_amount",placeholder:"0,00",type:"text",value:this.state.item_edit_amount.toFixed(2).toLocaleString()}))),u.a.createElement(N.a,null,u.a.createElement(g.a,{color:"secondary",onClick:this.toggleModalEditOpen},"Fechar"))))}}]),a}(m.Component);t.default=Object(p.b)((function(e){return{settings:e.settings,toasts:e.toasts}}),{addToast:w.e})(Object(h.f)(x))}}]);
//# sourceMappingURL=52.a372acb7.chunk.js.map