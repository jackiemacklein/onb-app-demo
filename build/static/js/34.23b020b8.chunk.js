(this["webpackJsonponb-app-demo.agenciaonside.com.br"]=this["webpackJsonponb-app-demo.agenciaonside.com.br"]||[]).push([[34],{234:function(e,t,a){"use strict";var l=a(241),n=a.n(l),r=a(18),i=a.n(r),s=n.a.create({baseURL:"https://onb-api-demo.agenciaonside.com.br"});s.interceptors.request.use((function(e){return e.headers.Authorization="bearer "+i.a.get("rui-auth-token"),e}),(function(e){Promise.reject(e)})),t.a=s},284:function(e,t,a){"use strict";a(285);var l=a(278),n=a.n(l),r=a(322),i=a.n(r);Object(l.registerLocale)("pt",i.a),t.a=n.a},285:function(e,t,a){},520:function(e,t,a){},644:function(e,t,a){"use strict";a.r(t);var l=a(331),n=a(21),r=a(332),i=a(239),s=a.n(i),c=a(240),o=a(2),u=a(3),m=a(14),d=a(5),f=a(4),p=(a(520),a(0)),b=a.n(p),_=a(26),h=a(10),g=a(633),v=a(518),E=a(519),y=a(276),j=a(227),O=a(228),N=a(368),k=a(369),F=a(370),S=a(645),C=a(371),x=a(646),M=a(18),w=a.n(M),D=a(242),U=a(11),L=a(23),T=a(22),z=a(284),R=a(234),H=a(679),P=a(639),A=a(323),V=a.n(A),$=function(e){Object(d.a)(a,e);var t=Object(f.a)(a);function a(e){var l;return Object(o.a)(this,a),(l=t.call(this,e)).state={page:0,page_limit:20,page_length:1,modalOpenIn:!1,modalOpenOut:!1,modalOpenTransf:!1,users:[{value:w.a.get("rui-auth-user_id"),label:w.a.get("rui-auth-user_name")}],filiais:[],sales:[],states:[{value:"open",label:"Em Aberto"},{value:"closed",label:"Fechadas/Finalizadas"},{value:"canceled",label:"Canceladas"}],term:"",loading:!1,calculations:{expected_in:0,realized_in:0},filter_start_date:new Date,filter_end_date:null,filter_filial_id:{value:"undefined"!=w.a.get("rui-auth-filial_id")?w.a.get("rui-auth-filial_id"):"",label:"undefined"!=w.a.get("rui-auth-filial_name")?w.a.get("rui-auth-filial_name"):"Selecione"},filter_state:{value:"",label:"Todas"}},l.loadFiliais=l.loadFiliais.bind(Object(m.a)(l)),l.loadSales=l.loadSales.bind(Object(m.a)(l)),l.filterHistory=l.filterHistory.bind(Object(m.a)(l)),l.calculations=l.calculations.bind(Object(m.a)(l)),l}return Object(u.a)(a,[{key:"calculations",value:function(){var e=Object(c.a)(s.a.mark((function e(t){var a,l,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=0,l=0,n=0;n<t.length;n++)"canceled"!==t[n].state&&(l+=t[n].amount),"closed"===t[n].state&&(a+=t[n].amount);this.setState({calculations:{realized_in:a,expected_in:l}});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadFiliais",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get("/filiais");case 3:t=e.sent,(a=t.data).length>0&&this.setState({filiais:a.map((function(e){return{value:e.id,label:e.name}}))}),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),console.log(e.t0),alert("Erro ao carregar filiais");case 12:case"end":return e.stop()}}),e,this,[[0,8]])})));return function(){return e.apply(this,arguments)}}()},{key:"loadSales",value:function(){var e=Object(c.a)(s.a.mark((function e(){var t,a,l,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=Object(H.a)(this.state.filter_start_date,"yyyy-MM-dd"),a=this.state.filter_end_date?Object(H.a)(this.state.filter_end_date,"yyyy-MM-dd"):Object(H.a)(this.state.filter_start_date,"yyyy-MM-dd"),e.next=5,R.a.get("/sales/?state=".concat(this.state.filter_state.value,"&start_date=").concat(t,"&end_date=").concat(a,"&filial_id=").concat(this.state.filter_filial_id.value));case 5:l=e.sent,n=l.data,this.setState({sales:n}),this.calculations(n),e.next=15;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0),alert("Erro ao carregar Lan\xe7amentos");case 15:case"end":return e.stop()}}),e,this,[[0,11]])})));return function(){return e.apply(this,arguments)}}()},{key:"filterHistory",value:function(e){var t,a,l;return!!((null===e||void 0===e||null===(t=e.client_name)||void 0===t?void 0:t.toUpperCase().includes(this.state.term.toUpperCase()))||(null===e||void 0===e||null===(a=e.title)||void 0===a?void 0:a.toUpperCase().includes(this.state.term.toUpperCase()))||(null===e||void 0===e||null===(l=e.user_name)||void 0===l?void 0:l.toUpperCase().includes(this.state.term.toUpperCase())))}},{key:"changeFilterDate",value:function(e){var t=Object(r.a)(e,2),a=t[0],l=t[1];this.setState({filter_start_date:a,filter_end_date:l})}},{key:"componentDidMount",value:function(){this.loadSales(),this.loadFiliais()}},{key:"componentDidUpdate",value:function(e,t){w.a.get("rui-auth-token")&&(t.filter_start_date===this.state.filter_start_date&&t.filter_end_date===this.state.filter_end_date&&t.filter_filial_id===this.state.filter_filial_id&&t.filter_state===this.state.filter_state||this.loadSales())}},{key:"render",value:function(){var e,t=this,a=this.state,r=a.sales,i=a.page_length,s=a.page,c=a.page_limit,o=[],u=r.filter((function(e){return""===t.state.term||t.filterHistory(e)}));i=Math.ceil(u.length/c);for(var m=0;m<i;m++)o.push(m);u=u.slice(s*c,s*c+c);var d={control:function(e,t){return Object(n.a)(Object(n.a)({},e),{},{borderColor:t.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0","&:hover":{borderColor:t.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0"},boxShadow:t.isFocused?"0 0 0 0.2rem rgba(114, 94, 195, 0.2)":""})},option:function(e,t){var a="";return t.isSelected?a="#725ec3":t.isFocused&&(a="rgba(114, 94, 195, 0.2)"),Object(n.a)(Object(n.a)({},e),{},{backgroundColor:a})},multiValueLabel:function(e){return Object(n.a)(Object(n.a)({},e),{},{color:"#545b61",backgroundColor:"#eeeeef"})}};return b.a.createElement(p.Fragment,null,b.a.createElement("div",{className:"bill-filters"},b.a.createElement(j.a,null,b.a.createElement(O.a,{xs:12,sm:12,md:3},b.a.createElement(y.a,{for:"filter_filial_id",className:"mt-10"},"Filial"),b.a.createElement(D.a,{id:"filter_filial_id",name:"filter_filial_id",defaultValue:this.state.filter_filial_id,value:this.state.filter_filial_id,options:[{value:"",label:"Selecione"}].concat(Object(l.a)(this.state.filiais)),styles:d,onChange:function(e){return t.setState({filter_filial_id:e})}})),b.a.createElement(O.a,{xs:12,sm:12,md:3},b.a.createElement(y.a,{for:"filter_state",className:"mt-10"},"Situa\xe7\xe3o"),b.a.createElement(D.a,{id:"filter_state",name:"filter_state",defaultValue:this.state.filter_state,value:this.state.filter_state,options:[{value:"",label:"Todos"}].concat(Object(l.a)(this.state.states)),styles:d,onChange:function(e){return t.setState({filter_state:e})}})),b.a.createElement(O.a,{xs:12,sm:12,md:6},b.a.createElement(y.a,{className:"mt-10"},"Per\xedodo"),b.a.createElement(L.a,{tag:"div",className:"",showTriangle:!0},b.a.createElement(L.a.Toggle,{tag:"button",className:"btn btn-brand btn-block mb-5"},b.a.createElement("span",{className:"text"},Object(H.a)(this.state.filter_start_date,"dd/MM/yyyy")," \xe0 ",Object(H.a)(null!==(e=this.state.filter_end_date)&&void 0!==e?e:this.state.filter_start_date,"dd/MM/yyyy")),b.a.createElement("span",{className:"icon icon ml-auto"},b.a.createElement(U.a,{name:"chevron-down"}))),b.a.createElement(L.a.Menu,{tag:"ul",className:"nav"},b.a.createElement("li",{onClick:function(){}},b.a.createElement(z.a,{selected:this.state.filter_start_date,onChange:function(e){return t.changeFilterDate(e)},startDate:this.state.filter_start_date,endDate:this.state.filter_end_date,selectsRange:!0,inline:!0,className:"rui-datetimepicker form-control w-auto",locale:"pt"}))))))),b.a.createElement("div",{className:"card"},b.a.createElement("div",{className:"card-body py-30 pt-0"},b.a.createElement("div",{className:"rui-project-task-search"},b.a.createElement("div",{className:"input-group input-group-clean"},b.a.createElement("input",{type:"search",className:"form-control pl-3 order-1",placeholder:"Digite para procurar...",value:this.state.term,onChange:function(e){return t.setState({term:e.target.value})}}))),b.a.createElement("div",{className:"rui-project-task-info"},b.a.createElement("a",{className:"rui-project-task-info-link ml-20 mr-0"},b.a.createElement("span",{className:"rui-project-task-info-title"},"Saldo: ")),b.a.createElement("a",{className:"rui-task-subtitle balance ml-10 mr-0 in"},b.a.createElement("strong",null,b.a.createElement("small",null,"R$ "),this.state.calculations.realized_in.toLocaleString())),b.a.createElement("a",{className:"rui-project-task-info-link ml-20 mr-0"},b.a.createElement("span",{className:"rui-project-task-info-title"},"Previsto: ")),b.a.createElement("a",{className:"rui-task-subtitle balance ml-10 mr-0 in"},b.a.createElement("strong",null,b.a.createElement("small",null,"R$ "),this.state.calculations.expected_in.toLocaleString()))),b.a.createElement("ul",{className:"list-group list-group-flush rui-project-task-list bills"},u.map((function(e,t){var a,l,n;return b.a.createElement("div",{className:"row-bill"},b.a.createElement("div",{className:"card-day"},0===t?b.a.createElement(b.a.Fragment,null,b.a.createElement("strong",null,Object(H.a)(Object(P.a)(e.date),"dd"))," ",b.a.createElement("small",null,Object(H.a)(Object(P.a)(e.date),"MMM",{locale:V.a}))):b.a.createElement(b.a.Fragment,null,u[t-1].date!==e.date?b.a.createElement(b.a.Fragment,null,b.a.createElement("strong",null,Object(H.a)(Object(P.a)(e.date),"dd"))," ",b.a.createElement("small",null,Object(H.a)(Object(P.a)(e.date),"MMM",{locale:V.a}))):b.a.createElement(b.a.Fragment,null))),b.a.createElement(N.a,{key:e.id,className:"card"},b.a.createElement(k.a,null,b.a.createElement(h.b,{to:"/pdv/show/".concat(e.id)},b.a.createElement(F.a,{className:"h2"},e.title)),b.a.createElement(S.a,{className:"h5 text-muted mb-2 card-subtitle mt-2"},"Aberto por: ",b.a.createElement("strong",null,null!==(a=null===e||void 0===e?void 0:e.user_name)&&void 0!==a?a:"-")),e.closed_by?b.a.createElement(b.a.Fragment,null,b.a.createElement(S.a,{className:"h5 text-muted mb-2 card-subtitle mt-2"},"Fechado por: ",b.a.createElement("strong",null,null!==(l=null===e||void 0===e?void 0:e.closed_by)&&void 0!==l?l:"-"))):b.a.createElement(b.a.Fragment,null),e.canceled_by?b.a.createElement(b.a.Fragment,null,b.a.createElement(S.a,{className:"h5 text-muted mb-2 card-subtitle mt-2"},"Cancelado por: ",b.a.createElement("strong",null,null!==(n=null===e||void 0===e?void 0:e.canceled_by)&&void 0!==n?n:"-"))):b.a.createElement(b.a.Fragment,null),b.a.createElement(S.a,{className:"h4 text-muted mb-5"},null===e||void 0===e?void 0:e.filial_name),e.client_id?b.a.createElement(b.a.Fragment,null,b.a.createElement(C.a,{className:"mb-5"},b.a.createElement(h.b,{to:"/crm/clientes/show/".concat(e.client_id),className:"card-link"},"Cliente: ",b.a.createElement("strong",null,null===e||void 0===e?void 0:e.client_name)))):b.a.createElement(b.a.Fragment,null),b.a.createElement(x.a,{className:"".concat(e.state," mt-10"),id:"popover_paid_".concat(e.id)},"closed"===e.state?"Fechada/Finalizada":"canceled"===e.state?"Cancelada":"Em aberto"),e.obs?b.a.createElement(b.a.Fragment,null,b.a.createElement(x.a,{id:"popover_obs_".concat(e.id)},"Observa\xe7\xf5es"),b.a.createElement(g.a,{placement:"top",target:"popover_obs_".concat(e.id),trigger:"hover"},b.a.createElement(v.a,null,"Observa\xe7\xf5es"),b.a.createElement(E.a,null,b.a.createElement("strong",null,e.obs)))):b.a.createElement(b.a.Fragment,null)),b.a.createElement("a",{className:"rui-task-subtitle price ".concat(e.state)},b.a.createElement("strong",null,b.a.createElement("small",null,"R$ "),e.amount.toLocaleString()))))}))))),b.a.createElement("nav",{className:"mt-15","aria-label":"Page navigation example"},b.a.createElement("ul",{className:"pagination pagination-sm"},b.a.createElement("ul",{className:"pagination pagination-sm"},o.map((function(e){return b.a.createElement("li",{key:e,onClick:function(){return t.setState({page:e})},className:"page-item ".concat(e===t.state.page?"active":"")},b.a.createElement("a",{className:"page-link"},e+1))}))))))}}]),a}(p.Component);t.default=Object(_.b)((function(e){return{settings:e.settings,toasts:e.toasts}}),{addToast:T.e,removeToast:T.f})($)}}]);
//# sourceMappingURL=34.23b020b8.chunk.js.map