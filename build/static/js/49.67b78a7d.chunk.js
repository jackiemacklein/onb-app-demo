(this["webpackJsonponb-app-demo.agenciaonside.com.br"]=this["webpackJsonponb-app-demo.agenciaonside.com.br"]||[]).push([[49],{237:function(e,t,a){"use strict";var n=a(246),s=a.n(n),i=a(18),r=a.n(i),l=s.a.create({baseURL:"https://onb-api-demo.agenciaonside.com.br"});l.interceptors.request.use((function(e){return e.headers.Authorization="bearer "+r.a.get("rui-auth-token"),e}),(function(e){Promise.reject(e)})),t.a=l},855:function(e,t,a){},930:function(e,t,a){"use strict";a.r(t);var n=a(36),s=a(21),i=a(244),r=a.n(i),l=a(245),o=a(2),d=a(3),c=a(14),u=a(5),h=a(4),m=(a(700),a(739),a(855),a(0)),f=a.n(m),b=a(26),v=a(748),p=a(701),g=a(740),E=a(741),y=a(747),O=a(19),S=a(353),j=a(346),_=a(347),k=a(90),w=a(261),x=a(429),C=a(262),D=a(249),A=a(953),F=a(307),N=a(11),T=a(237),M=a(22),z=function(e){Object(u.a)(a,e);var t=Object(h.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={options:{locale:"pt-br",defaultView:"dayGridMonth",plugins:[p.b,g.a,E.a,y.a],header:{left:"prev,next, today",center:"title",right:"dayGridMonth,timeGridDay,listWeek"},eventLimit:!0,eventLimitText:"More",events:[]},events:[],id:"",schedule_id:"",data:{name:"",phone:"",email:"",cpf:"",profile:{name:""},schedules:[]},modalOpen:!1,user_id:"",filial_id:"",date:"",obs:"",filiais:[],users:[],loading:!1,states:[{value:"scheduled",label:"Agendado"},{value:"canceled",label:"Cancelado"},{value:"realized",label:"Realizado"}]},n.loadData=n.loadData.bind(Object(c.a)(n)),n.toggle=n.toggle.bind(Object(c.a)(n)),n.loadUsers=n.loadUsers.bind(Object(c.a)(n)),n.loadFiliais=n.loadFiliais.bind(Object(c.a)(n)),n.handleSchedule=n.handleSchedule.bind(Object(c.a)(n)),n.handleScheduleSave=n.handleScheduleSave.bind(Object(c.a)(n)),n}return Object(d.a)(a,[{key:"loadData",value:function(){var e=Object(l.a)(r.a.mark((function e(){var t,a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.match.params.id,e.next=3,T.a.get("crm/clients/".concat(t));case 3:a=e.sent,n=a.data,this.setState({data:n,events:n.schedules.map((function(e){return{id:e.id,title:L(e.state),start:Object(A.a)(Object(F.a)(e.date),"yyyy'-'MM'-'dd'T'HH:mm"),allDay:!1,className:"fc-event-".concat(e.state),schedule:e}})),id:t});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"toggle",value:function(){this.setState((function(e){return{modalOpen:!e.modalOpen}}))}},{key:"loadUsers",value:function(){var e=Object(l.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.get("users/");case 2:t=e.sent,a=t.data,this.setState({users:a.map((function(e){return{value:e.id,label:e.name}}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"loadFiliais",value:function(){var e=Object(l.a)(r.a.mark((function e(){var t,a;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.a.get("filiais/");case 2:t=e.sent,a=t.data,this.setState({filiais:a.map((function(e){return{value:e.id,label:e.name}}))});case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleSchedule",value:function(e){var t,a,n,s,i,r;e=this.state.data.schedules.find((function(t){return t.id==e.event.id}));var l=this.props.addToast;if("canceled"===e.state||"rescheduled"===e.state)return l({title:"Aten\xe7\xe3o!",content:"N\xe3o \xe9 possivel editar agedamentos cancelados e/ou reagendados.",time:new Date,duration:1e4,color:"info"}),!1;var o={value:null===(t=e)||void 0===t?void 0:t.user_id,label:null===(a=e)||void 0===a||null===(n=a.user)||void 0===n?void 0:n.name},d=e.client_id,c={value:null===(s=e)||void 0===s?void 0:s.filial_id,label:null===(i=e)||void 0===i||null===(r=i.filial)||void 0===r?void 0:r.name},u=this.state.states.find((function(t){return t.value===e.state})),h=Object(A.a)(Object(F.a)(e.date),"yyyy'-'MM'-'dd'T'HH:mm");this.setState({schedule_id:e.id,user_id:o,client_id:d,filial_id:c,date:h,obs:e.obs,state:u}),this.toggle()}},{key:"handleScheduleSave",value:function(){var e=Object(l.a)(r.a.mark((function e(t){var a,n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),a=this.props.addToast,this.state.date&&this.state.filial_id&&this.state.user_id){e.next=5;break}return alert("Os campos DATA, FILIAL E ATENDENTE s\xe3o obrigat\xf3rios."),e.abrupt("return",!1);case 5:return e.prev=5,this.setState({loading:!0}),e.next=9,T.a.put("/crm/schedules/".concat(this.state.schedule_id),{client_id:this.state.id,user_id:this.state.user_id.value,filial_id:this.state.filial_id.value,date:this.state.date,obs:this.state.obs,state:this.state.state.value});case 9:n=e.sent,n.data,this.toggle(),a({title:"Sucesso!.",content:"Agendamento atualizado com sucesso.",time:new Date,duration:1e4,color:"success"}),this.loadData(),e.next=20;break;case 16:e.prev=16,e.t0=e.catch(5),e.t0.response&&e.t0.response.data&&!0===e.t0.response.data.error?alert(e.t0.response.data.more):alert("Erro ao atualizado agendamento"),console.log(e.t0);case 20:this.setState({loading:!1});case 21:case"end":return e.stop()}}),e,this,[[5,16]])})));return function(t){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.loadData(),this.loadUsers(),this.loadFiliais()}},{key:"render",value:function(){var e=this,t=this.state,a=t.options,i=t.events;a.events=i;var r={control:function(e,t){return Object(s.a)(Object(s.a)({},e),{},{borderColor:t.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0","&:hover":{borderColor:t.isFocused?"rgba(114, 94, 195, 0.6)":"#eaecf0"},boxShadow:t.isFocused?"0 0 0 0.2rem rgba(114, 94, 195, 0.2)":""})},option:function(e,t){var a="";return t.isSelected?a="#725ec3":t.isFocused&&(a="rgba(114, 94, 195, 0.2)"),Object(s.a)(Object(s.a)({},e),{},{backgroundColor:a})},multiValueLabel:function(e){return Object(s.a)(Object(s.a)({},e),{},{color:"#545b61",backgroundColor:"#eeeeef"})}};return f.a.createElement(m.Fragment,null,f.a.createElement("div",{className:"rui-calendar rui-calendar-navs"},f.a.createElement(v.a,Object(n.a)({},a,{eventClick:this.handleSchedule}))),f.a.createElement(S.a,{isOpen:this.state.modalOpen,toggle:this.toggle,className:this.props.className,fade:!0},f.a.createElement("form",{onSubmit:this.handleScheduleSave},f.a.createElement("div",{className:"modal-header"},f.a.createElement("h5",{className:"modal-title h2"},"Editar Agendamento"),f.a.createElement(k.a,{className:"close",color:"",onClick:this.toggle},f.a.createElement(N.a,{name:"x"}))),f.a.createElement(j.a,null,"Editar agendamento para ",f.a.createElement("mark",{className:"display-4"},this.state.data.name),f.a.createElement("br",null),f.a.createElement("br",null),f.a.createElement(w.a,null,f.a.createElement(x.a,{for:"state"},"Situa\xe7\xe3o *"),f.a.createElement(D.a,{id:"state",name:"state",required:!0,defaultValue:this.state.state,options:this.state.states,styles:r,onChange:function(t){return e.setState({state:t})}})),f.a.createElement(w.a,null,f.a.createElement(x.a,{for:"filial_id"},"Filial *"),f.a.createElement(D.a,{id:"filial_id",name:"filial_id",required:!0,defaultValue:this.state.filial_id,options:this.state.filiais,styles:r,onChange:function(t){return e.setState({filial_id:t})}})),f.a.createElement(w.a,null,f.a.createElement(x.a,{for:"user_id"},"Atendente *"),f.a.createElement(D.a,{id:"user_id",name:"user_id",required:!0,defaultValue:this.state.user_id,options:this.state.users,styles:r,onChange:function(t){return e.setState({user_id:t})}})),f.a.createElement(w.a,null,f.a.createElement(x.a,{for:"date"},"Data e Hora *"),f.a.createElement(C.a,{id:"date",name:"date",required:!0,min:new Date,placeholder:"01/01/2021",type:"datetime-local",value:this.state.date,onChange:function(t){return e.setState({date:t.target.value})}})),f.a.createElement(w.a,null,f.a.createElement(x.a,{for:"obs"},"Observa\xe7\xf5es"),f.a.createElement(C.a,{id:"obs",name:"obs",placeholder:"",type:"text",value:this.state.obs,onChange:function(t){return e.setState({obs:t.target.value})}}))),f.a.createElement(_.a,null,f.a.createElement(k.a,{color:"secondary",type:"button",onClick:this.toggle,disabled:this.state.loading},"Fechar")," ",f.a.createElement(k.a,{color:"success",type:"submit",disabled:this.state.loading},this.state.loading?"Salvando...":"Salvar")))))}}]),a}(m.Component);function L(e){return"scheduled"===e?"Agendado":"canceled"===e?"Cancelado":"realized"===e?"Realizado/Atendido":"rescheduled"===e?"Reagendado":void 0}t.default=Object(b.b)((function(e){return{settings:e.settings,toasts:e.toasts}}),{addToast:M.e,removeToast:M.f})(Object(O.f)(z))}}]);
//# sourceMappingURL=49.67b78a7d.chunk.js.map